<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Overview</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/nouislider@15.7.1/dist/nouislider.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nouislider@15.7.1/dist/nouislider.min.css">
    <script src="script.js"></script>
</head>
<body>
    <div class="sidebar">
        <img src="logo.png" alt="Logo" class="sidebar-logo">
        <div class="select-container">
            <label for="source-select">Source:</label>
            <select id="source-select">
                <option value="Nasdaq">Nasdaq</option>
                <option value="yfinance" selected>yfinance</option>
            </select>
        </div>
        <div class="select-container">
            <label for="date-select">Date:</label>
            <select id="date-select"></select>
        </div>
        <div class="select-container">
            <label for="time-select">Time:</label>
            <select id="time-select"></select>
        </div>
        <div class="select-container">
            <label for="ticker-search">Ticker:</label>
            <input type="text" id="ticker-search" placeholder="Enter ticker">
        </div>
        <a href="#" onclick="updateSection('overview')">Overview</a>
        <a href="#" onclick="updateSection('volatility')">Volatility</a>
        <a href="#" onclick="updateSection('ranking')">Ranking</a>
        <a href="#" onclick="updateSection('stock')">Stock</a>
        <a href="#" onclick="updateSection('raw-data')">Data Table</a>
    </div>
    <div class="main-content">
        <div class="ticker-display" id="ticker-display">N/A</div>
        <div class="overview-grid" id="overview">
            <div class="chart-container historic-container">
                <h2>Historic Stock Price</h2>
                <div class="select-container">
                    <button class="arrow-button" onclick="changeHistorySelect(-1)">◀</button>
                    <select id="history-select">
                        <option value="1-month">1-month</option>
                        <option value="3-month">3-month</option>
                        <option value="6-month">6-month</option>
                        <option value="1-year">1-year</option>
                        <option value="5-year">5-year</option>
                        <option value="all">All</option>
                    </select>
                    <button class="arrow-button" onclick="changeHistorySelect(1)">▶</button>
                </div>
                <canvas id="historic-price-chart"></canvas>
                <div id="historic-error" class="error-message" style="display: none;">No historic data available</div>
            </div>
            <div class="chart-container summary-container">
                <h2>Summary</h2>
                <table class="summary-table" id="summary-table"></table>
            </div>
            <div class="chart-container contracts-container">
                <h2>Top 10 Volume Contracts</h2>
                <table class="contracts-table" id="top-volume-table"></table>
            </div>
            <div class="chart-container contracts-container">
                <h2>Top 10 Open Interest Contracts</h2>
                <table class="contracts-table" id="top-open-interest-table"></table>
            </div>
        </div>
        <div class="volatility-grid" id="volatility" style="display: none;">
            <div class="chart-container">
                <h2>Implied Volatility Smile</h2>
                <div class="select-container">
                    <button class="arrow-button" onclick="changeExpirySelect(-1)">◀</button>
                    <select id="expiry-select"></select>
                    <button class="arrow-button" onclick="changeExpirySelect(1)">▶</button>
                </div>
                <canvas id="moneyness-vs-iv-chart"></canvas>
                <div class="error-message" id="moneyness-vs-iv-error">No data available</div>
            </div>
            <div class="chart-container">
                <h2>Implied Volatility Term Structure</h2>
                <div class="select-container">
                    <button class="arrow-button" onclick="changeMoneynessSelect(-1)">◀</button>
                    <select id="moneyness-select"></select>
                    <button class="arrow-button" onclick="changeMoneynessSelect(1)">▶</button>
                </div>
                <canvas id="expiry-vs-iv-chart"></canvas>
                <div class="error-message" id="expiry-vs-iv-error">No data available</div>
            </div>
            <div class="chart-container">
                <h2>Yahoo Finance Implied Volatility Smile</h2>
                <div class="select-container">
                    <button class="arrow-button" onclick="changeYFExpirySelect(-1)">◀</button>
                    <select id="yf-expiry-select"></select>
                    <button class="arrow-button" onclick="changeYFExpirySelect(1)">▶</button>
                </div>
                <canvas id="yf-iv-chart"></canvas>
                <div class="error-message" id="yf-iv-error">No data available</div>
            </div>
            <div class="chart-container">
                <h2>Volatility Skewness</h2>
                <canvas id="skew-vs-expiry-chart"></canvas>
                <div class="error-message" id="skew-vs-expiry-error">No data available</div>
            </div>
            <div class="chart-container">
                <h2>Realised Volatility</h2>
                <div class="select-container">
                    <button class="arrow-button" onclick="changeRealisedVolHistorySelect(-1)">◀</button>
                    <select id="realised-vol-history-select">
                        <option value="1-month">1-month</option>
                        <option value="3-month">3-month</option>
                        <option value="6-month">6-month</option>
                        <option value="1-year">1-year</option>
                        <option value="5-year">5-year</option>
                        <option value="all">All</option>
                    </select>
                    <button class="arrow-button" onclick="changeRealisedVolHistorySelect(1)">▶</button>
                </div>
                <canvas id="realised-vol-chart"></canvas>
                <div class="error-message" id="realised-vol-error">No data available</div>
            </div>
            <div class="chart-container">
                <h2>Call Volatility Surface</h2>
                <div class="slider-container">
                    <div class="slider-group">
                        <label for="moneyness-slider">Moneyness Range:</label>
                        <div id="moneyness-slider"></div>
                        <span id="moneyness-value">0.6 - 2.5</span>
                    </div>
                    <div class="slider-group">
                        <label for="expiry-t-slider">Expiry (T) Range:</label>
                        <div id="expiry-t-slider"></div>
                        <span id="expiry-t-value">0.2 - 5.0</span>
                    </div>
                </div>
                <div id="call-vol-surface"></div>
                <div class="error-message" id="call-vol-surface-error">No data available</div>
            </div>
        </div>
        <div class="chart-container" id="ranking" style="display: none;">
            <h2>Ticker Ranking</h2>
            <button class="toggle-button" onclick="toggleTable('ranking-table')">Show Data</button>
            <div class="ranking-grid">
                <div class="chart-container">
                    <h2>Volume</h2>
                    <canvas id="volume-chart"></canvas>
                </div>
                <div class="chart-container">
                    <h2>Open Interest</h2>
                    <canvas id="open-interest-chart"></canvas>
                </div>
            </div>
            <table class="ranking-table" id="ranking-table" style="display: none;"></table>
        </div>
        <div class="chart-container" id="stock" style="display: none;">
            <h2>Stock Metrics</h2>
            <button class="toggle-button" onclick="toggleTable('stock-table')">Show Data</button>
            <table class="stock-table" id="stock-table" style="display: none;"></table>
        </div>
        <div class="chart-container" id="raw-data" style="display: none;">
            <h2>Data Table</h2>
            <table class="raw-data-table" id="raw-data-table"></table>
        </div>
    </div>
</body>
</html>
